const a7_0x445c=['wait','@nrwl/workspace/src/tasks-runner/cache','Successfully\x20completed\x20running\x20the\x20command.','self','nx.json','Unable\x20to\x20complete\x20a\x20run.','length','url','apply','projectGraph','criticalErrorMessage','value','completedTasks','map','target','parse','dependencies','finally','get','ENCRYPTION_KEY','scheduleTask','axiosException','configuration','retrieve','taskId','reset','DistributedExecutionApi','encryptionKey','find','next','logCommand','Found\x20unknown\x20task:\x20','../../file-storage/file-storage','nxCloudDistributedTasksRunner','getDependencyConfigs','targetDependencies','nodes','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','has','then','createStartRequest','See\x20run\x20details\x20at\x20','__esModule','getRunGroup','createNoNewMessagesTimeout','output','FileStorage','Cache','runUrl','strictlyOrderedTargets','start','../../../utilities/create-no-new-messages-timeout','executionId:\x20','stdout','Extracting\x20artifacts','./node_modules/.cache/nx','./distributed-execution.api','defineProperty','lifeCycle','defaultTargetDependencies','copyFilesFromCache','executionStatus:\x20','executionStatus','project','push','toString','splitTasksIntoStages','rxjs/internal/Observable','run','readFileSync','COMPLETED','Command\x20execution\x20failed.','getOutputs','number\x20of\x20completed\x20tasks:\x20','Waiting...','@nrwl/workspace/src/tasks-runner/utils','Observable','projects','unparse','size','../../../utilities/waiter','catch','assign','message','error:\x20','error','E2EEncryption','commandStatus','hash','note','log','build','printRunGroupError','VERBOSE_LOGGING','exit','tasks','Processing\x20task\x20','endTask'];(function(_0x5e5d58,_0x445cf4){const _0x48119b=function(_0x5bcbe0){while(--_0x5bcbe0){_0x5e5d58['push'](_0x5e5d58['shift']());}};_0x48119b(++_0x445cf4);}(a7_0x445c,0x1f0));const a7_0x4811=function(_0x5e5d58,_0x445cf4){_0x5e5d58=_0x5e5d58-0x0;let _0x48119b=a7_0x445c[_0x5e5d58];return _0x48119b;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x52602d,_0x49c5f4,_0x5cf48d,_0x23688a){function _0xf60914(_0x5cbe47){return _0x5cbe47 instanceof _0x5cf48d?_0x5cbe47:new _0x5cf48d(function(_0x20e6f4){_0x20e6f4(_0x5cbe47);});}return new(_0x5cf48d||(_0x5cf48d=Promise))(function(_0x5bfc33,_0x3748d3){function _0x1c38d8(_0x154e42){try{_0x410fc7(_0x23688a[a7_0x4811('0x17')](_0x154e42));}catch(_0x57cdb7){_0x3748d3(_0x57cdb7);}}function _0x2134d6(_0x343c0a){try{_0x410fc7(_0x23688a['throw'](_0x343c0a));}catch(_0x9ae629){_0x3748d3(_0x9ae629);}}function _0x410fc7(_0x2086e){_0x2086e['done']?_0x5bfc33(_0x2086e[a7_0x4811('0x5')]):_0xf60914(_0x2086e[a7_0x4811('0x5')])[a7_0x4811('0x21')](_0x1c38d8,_0x2134d6);}_0x410fc7((_0x23688a=_0x23688a[a7_0x4811('0x2')](_0x52602d,_0x49c5f4||[]))['next']());});};Object[a7_0x4811('0x33')](exports,a7_0x4811('0x24'),{'value':!![]});exports[a7_0x4811('0x1b')]=void 0x0;const Observable_1=require(a7_0x4811('0x3d'));const cache_1=require(a7_0x4811('0x5d'));const output_1=require('@nrwl/workspace/src/utilities/output');const utils_1=require(a7_0x4811('0x45'));const stripJsonComments=require('strip-json-comments');const fs_1=require('fs');const distributed_execution_api_1=require(a7_0x4811('0x32'));const file_storage_1=require(a7_0x4811('0x1a'));const e2e_encryption_1=require('../../file-storage/e2e-encryption');const waiter_1=require(a7_0x4811('0x4a'));const environment_1=require('../../../utilities/environment');const print_run_group_error_1=require('../../error/print-run-group-error');const create_no_new_messages_timeout_1=require(a7_0x4811('0x2d'));class NoopLifeCycle{[a7_0x4811('0xe')](_0x9a681c){}['startTask'](_0x54300b){}[a7_0x4811('0x5b')](_0x4712c7,_0x4c4c76){}}function runDistributedExecution(_0x17fc8a,_0x5c0567,_0x2c24e6,_0x55d569,_0x2c7d10,_0x75a314,_0x55ea0a){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4155c3=JSON[a7_0x4811('0x9')](stripJsonComments(fs_1[a7_0x4811('0x3f')](a7_0x4811('0x60'))[a7_0x4811('0x3b')]()));const _0xead2e3=new TaskOrderer(_0x2c24e6[a7_0x4811('0x3')],getDefaultDependencyConfigs(_0x4155c3,_0x5c0567))[a7_0x4811('0x3c')](_0x55ea0a);const _0x18fabc=yield _0x17fc8a[a7_0x4811('0x2c')](distributed_execution_api_1[a7_0x4811('0x22')](_0x75a314,_0xead2e3,_0x5c0567));return yield processTasks(_0x17fc8a,_0x55d569,_0x2c7d10,_0x5c0567,_0x18fabc,_0x55ea0a,_0x2c24e6);});}function processTasks(_0x5123d8,_0x3cb99c,_0x4a4e6b,_0xf8bbbc,_0xacb68f,_0x8ed89b,_0x26432e){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4995d8={};const _0x34bafd=create_no_new_messages_timeout_1[a7_0x4811('0x26')]();const _0x656c2e=new waiter_1['Waiter']();while(!![]){if(environment_1[a7_0x4811('0x57')]){output_1['output'][a7_0x4811('0x53')]({'title':a7_0x4811('0x44')});}yield _0x656c2e[a7_0x4811('0x5c')]();const _0x82fa9f=yield _0x5123d8['status'](_0xacb68f);if(environment_1['VERBOSE_LOGGING']){output_1[a7_0x4811('0x27')][a7_0x4811('0x53')]({'title':'Status\x20update','bodyLines':[a7_0x4811('0x2e')+_0xacb68f,a7_0x4811('0x37')+_0x82fa9f[a7_0x4811('0x38')],a7_0x4811('0x43')+_0x82fa9f['completedTasks']['length'],a7_0x4811('0x4e')+_0x82fa9f[a7_0x4811('0x4')]]});}if(_0x82fa9f[a7_0x4811('0x4')]){output_1[a7_0x4811('0x27')][a7_0x4811('0x4f')]({'title':'Distributed\x20Execution\x20Terminated','bodyLines':['Error:',_0x82fa9f[a7_0x4811('0x4')]]});process['exit'](0x1);}_0x34bafd(_0x82fa9f['completedTasks']['length']);for(const _0x969e53 of _0x82fa9f[a7_0x4811('0x6')]){if(_0x4995d8[_0x969e53[a7_0x4811('0x12')]])continue;yield processTask(_0x3cb99c,_0x4a4e6b,_0x26432e,_0xf8bbbc,_0x8ed89b,_0x969e53);_0x656c2e[a7_0x4811('0x13')]();_0x4995d8[_0x969e53[a7_0x4811('0x12')]]=!![];}if(_0x82fa9f['executionStatus']===a7_0x4811('0x40')){return{'commandStatus':_0x82fa9f[a7_0x4811('0x51')],'runUrl':_0x82fa9f['runUrl']};}}});}function processTask(_0x500812,_0x2bad53,_0x2c17b9,_0x4456a2,_0x5d0ac1,_0x11c711){return __awaiter(this,void 0x0,void 0x0,function*(){if(environment_1['VERBOSE_LOGGING']){output_1['output']['note']({'title':a7_0x4811('0x5a')+_0x11c711[a7_0x4811('0x12')]});}const _0x480ac2=_0x5d0ac1[a7_0x4811('0x16')](_0x5a6240=>_0x11c711[a7_0x4811('0x12')]===_0x5a6240['id']);if(!_0x480ac2){throw new Error(a7_0x4811('0x19')+_0x11c711[a7_0x4811('0x12')]);}if(environment_1[a7_0x4811('0x57')]){output_1[a7_0x4811('0x27')][a7_0x4811('0x53')]({'title':'Retrieving\x20artifacts\x20from\x20'+_0x11c711[a7_0x4811('0x1')]});}yield _0x500812[a7_0x4811('0x11')](_0x11c711[a7_0x4811('0x52')],_0x11c711[a7_0x4811('0x1')],_0x4456a2['cacheDirectory']||a7_0x4811('0x31'));const _0x2ca7ae=yield _0x2bad53[a7_0x4811('0xc')](Object[a7_0x4811('0x4c')](Object[a7_0x4811('0x4c')]({},_0x480ac2),{'hash':_0x11c711[a7_0x4811('0x52')]}));const _0xc9ab58=utils_1[a7_0x4811('0x42')](_0x2c17b9['projectGraph'][a7_0x4811('0x1e')],_0x480ac2);if(environment_1[a7_0x4811('0x57')]){output_1[a7_0x4811('0x27')][a7_0x4811('0x53')]({'title':a7_0x4811('0x30'),'bodyLines':_0xc9ab58});}_0x2bad53[a7_0x4811('0x36')](_0x11c711[a7_0x4811('0x52')],_0x2ca7ae,_0xc9ab58);output_1[a7_0x4811('0x27')][a7_0x4811('0x18')](getCommand(_0x480ac2));process[a7_0x4811('0x2f')]['write'](_0x2ca7ae['terminalOutput']);output_1['output']['addVerticalSeparator']();});}function getCommand(_0x4094e2){const _0x37a3da=utils_1[a7_0x4811('0x48')](_0x4094e2['overrides']||{});const _0x1149e7=_0x4094e2[a7_0x4811('0x8')][a7_0x4811('0x10')]?':'+_0x4094e2[a7_0x4811('0x8')][a7_0x4811('0x10')]:'';return['nx',a7_0x4811('0x3e'),_0x4094e2['target'][a7_0x4811('0x39')]+':'+_0x4094e2[a7_0x4811('0x8')][a7_0x4811('0x8')]+_0x1149e7,..._0x37a3da]['join']('\x20');}const nxCloudDistributedTasksRunner=(_0x573126,_0x22af17,_0x2367f7)=>{if(environment_1['VERBOSE_LOGGING']){output_1[a7_0x4811('0x27')]['note']({'title':'Starting\x20distributed\x20command\x20execution'});}_0x22af17[a7_0x4811('0x34')]=new NoopLifeCycle();const _0x10ed21=environment_1[a7_0x4811('0x25')]();if(!_0x10ed21){print_run_group_error_1[a7_0x4811('0x56')]();return process['exit'](0x1);}const _0x30beb8=new e2e_encryption_1[(a7_0x4811('0x50'))](environment_1[a7_0x4811('0xd')]||_0x22af17[a7_0x4811('0x15')]);const _0x1fecd7=new file_storage_1[(a7_0x4811('0x28'))](_0x30beb8,0x3);const _0x1f2845=new cache_1[(a7_0x4811('0x29'))](_0x22af17);const _0xe196aa=new distributed_execution_api_1[(a7_0x4811('0x14'))](_0x22af17);runDistributedExecution(_0xe196aa,_0x22af17,_0x2367f7,_0x1fecd7,_0x1f2845,_0x10ed21,_0x573126)['then'](_0x56654c=>{if(_0x56654c['commandStatus']===0x0){output_1[a7_0x4811('0x27')]['success']({'title':a7_0x4811('0x5e'),'bodyLines':[a7_0x4811('0x23')+_0x56654c[a7_0x4811('0x2a')]]});}else{output_1[a7_0x4811('0x27')][a7_0x4811('0x4f')]({'title':a7_0x4811('0x41'),'bodyLines':[a7_0x4811('0x23')+_0x56654c[a7_0x4811('0x2a')]]});}process[a7_0x4811('0x58')](_0x56654c['commandStatus']);})[a7_0x4811('0x4b')](_0x68c13d=>{output_1[a7_0x4811('0x27')][a7_0x4811('0x4f')]({'title':a7_0x4811('0x61'),'bodyLines':[_0x68c13d[a7_0x4811('0x4d')]]});if(_0x68c13d[a7_0x4811('0xf')]){console[a7_0x4811('0x54')](_0x68c13d[a7_0x4811('0xf')]);}else{console['log'](_0x68c13d);}_0xe196aa['completeRunGroupWithError'](_0x10ed21,a7_0x4811('0x1f')+_0x68c13d[a7_0x4811('0x4d')]+'\x22')[a7_0x4811('0xb')](()=>process[a7_0x4811('0x58')](0x1));});return new Observable_1[(a7_0x4811('0x46'))](()=>{});};exports[a7_0x4811('0x1b')]=nxCloudDistributedTasksRunner;class TaskOrderer{constructor(_0x4b765d,_0x2af50d){this[a7_0x4811('0x3')]=_0x4b765d;this[a7_0x4811('0x35')]=_0x2af50d;}[a7_0x4811('0x3c')](_0x1a11e3){if(_0x1a11e3[a7_0x4811('0x0')]===0x0)return[];const _0xe174c=[];const _0x578e28=this['createTaskGraph'](_0x1a11e3);const _0x46c8a3=new Set(_0x1a11e3[a7_0x4811('0x7')](_0x46e86b=>_0x46e86b['id']));let _0x3ddf27=0x0;while(_0x46c8a3[a7_0x4811('0x49')]>0x0){const _0x1ac684=_0xe174c[_0x3ddf27]=[];for(const _0x1c589d of _0x46c8a3){let _0x40ad43=!![];for(const _0x1d14c8 of _0x578e28[a7_0x4811('0xa')][_0x1c589d]){if(_0x46c8a3[a7_0x4811('0x20')](_0x1d14c8)){_0x40ad43=![];break;}}if(!_0x40ad43){continue;}const _0x972931=_0x578e28[a7_0x4811('0x59')][_0x1c589d];_0x1ac684[a7_0x4811('0x3a')](_0x972931);}for(const _0x21f67b of _0x1ac684){_0x46c8a3['delete'](_0x21f67b['id']);}_0x3ddf27++;}return _0xe174c;}['createTaskGraph'](_0x23ebf3){const _0x8fa717={'tasks':{},'dependencies':{}};for(const _0x3f8e06 of _0x23ebf3){_0x8fa717[a7_0x4811('0x59')][_0x3f8e06['id']]=_0x3f8e06;_0x8fa717[a7_0x4811('0xa')][_0x3f8e06['id']]=[];const _0x2dedce=utils_1[a7_0x4811('0x1c')](_0x3f8e06[a7_0x4811('0x8')],this[a7_0x4811('0x35')],this[a7_0x4811('0x3')]);if(!_0x2dedce){continue;}const _0x11d7e3=new Set(this[a7_0x4811('0x3')][a7_0x4811('0xa')][_0x3f8e06[a7_0x4811('0x8')]['project']][a7_0x4811('0x7')](_0x210bcc=>_0x210bcc['target']));for(const _0x10a113 of _0x2dedce){if(_0x10a113['projects']===a7_0x4811('0x5f')){for(const _0x34ddb7 of _0x23ebf3){if(_0x34ddb7['target'][a7_0x4811('0x39')]===_0x3f8e06[a7_0x4811('0x8')][a7_0x4811('0x39')]&&_0x34ddb7[a7_0x4811('0x8')]['target']===_0x10a113[a7_0x4811('0x8')]){_0x8fa717['dependencies'][_0x3f8e06['id']][a7_0x4811('0x3a')](_0x34ddb7['id']);}}}else if(_0x10a113[a7_0x4811('0x47')]===a7_0x4811('0xa')){for(const _0x152c5b of _0x23ebf3){if(_0x11d7e3[a7_0x4811('0x20')](_0x152c5b['target']['project'])&&_0x152c5b['target'][a7_0x4811('0x8')]===_0x10a113[a7_0x4811('0x8')]){_0x8fa717['dependencies'][_0x3f8e06['id']][a7_0x4811('0x3a')](_0x152c5b['id']);}}}}}return _0x8fa717;}}function getDefaultDependencyConfigs(_0x1ffeb6,_0x1c760f){var _0x2036e3,_0x7f13a9;const _0x2f627d=(_0x2036e3=_0x1ffeb6[a7_0x4811('0x1d')])!==null&&_0x2036e3!==void 0x0?_0x2036e3:{};const _0x41695b=_0x1c760f?(_0x7f13a9=_0x1c760f[a7_0x4811('0x2b')])!==null&&_0x7f13a9!==void 0x0?_0x7f13a9:[a7_0x4811('0x55')]:[];for(const _0x1257d0 of _0x41695b){_0x2f627d[_0x1257d0]=_0x2f627d[_0x1257d0]||[];_0x2f627d[_0x1257d0][a7_0x4811('0x3a')]({'target':_0x1257d0,'projects':a7_0x4811('0xa')});}return _0x2f627d;}